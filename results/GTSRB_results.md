## GTSRB

For the Dataset, various setups were run for 25 epochs to get a general impression of the algorithms.
By simply comparing both PCA methods, neither faiss nor scikit-learn's implementation were able to outperform each other. We clearly noticed that no PCA method created better environments for the upcoming clustering algorithm.
Instead, we noticed that 

![image](../images/GTSRB_Overview_AlexNet_VGG16_ResNet18_FeedForward_Sobel.png)


#### AlexNet
**Without Sobel**:
```bash
python3 main.py --arch AlexNet --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head;
```

**With Sobel**:
```bash
python3 main.py --arch AlexNet --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head;
```

**Adjusted class size**
```bash (dacit)
for i in 20 50 100; do python3 main.py --arch AlexNet --input_dim 3 --num_classes $i --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 3 --num_classes $i --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 2 --num_classes $i --grayscale --sobel --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch AlexNet --input_dim 2 --num_classes $i --grayscale --sobel --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; done
```
---

#### VGG16
**Without Sobel**:
```bash (aplit)
python3 main.py --arch VGG16 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch VGG16 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch VGG16 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch VGG16 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; 
```

**With Sobel**:
```bash (aplit)
python3 main.py --arch VGG16 --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch VGG16 --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch VGG16 --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch VGG16 --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; 
```
---

#### ResNet18
**Without Sobel**:
```bash
python3 main.py --arch ResNet18 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; 
```

**With Sobel**:
```bash
python3 main.py --arch ResNet18 --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; 
```

**Adjusted class size**
```bash (charnockit)
for i in 20 50 100; do python3 main.py --arch ResNet18 --input_dim 3 --num_classes $i --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 3 --num_classes $i --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 2 --num_classes $i --grayscale --sobel --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch ResNet18 --input_dim 2 --num_classes $i --grayscale --sobel --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; done
```

---

#### FeedForward (Without PCA due to lower Feature Space)
**Without Sobel**:
```bash
python3 main.py --arch FeedForward --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch FeedForward --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; 
```

**With Sobel**:
```bash
python3 main.py --arch FeedForward --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch FeedForward --input_dim 2 --grayscale --sobel --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; 
```

**Adjusted class size**
```bash (diatomit)
for i in 20 50 100; do python3 main.py --arch FeedForward --input_dim 3 --num_classes $i --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch FeedForward --input_dim 3 --num_classes $i --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch FeedForward --input_dim 2 --num_classes $i --grayscale --sobel --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; python3 main.py --arch FeedForward --input_dim 2 --num_classes $i --grayscale --sobel --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --remove_head; done
```

---

## Adam Optimizer
**Without Sobel**
```bash (enderbit)
python3 main.py --arch AlexNet --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam; python3 main.py --arch AlexNet --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam; python3 main.py --arch VGG16 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam; python3 main.py --arch VGG16 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam; python3 main.py --arch ResNet18 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam; python3 main.py --arch ResNet18 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam; python3 main.py --arch FeedForward --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam; python3 main.py --arch FeedForward --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam;
```

**With Sobel**
```bash (diamiktit)
python3 main.py --arch AlexNet --input_dim 2 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam --sobel --grayscale; python3 main.py --arch AlexNet --input_dim 2 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam --sobel --grayscale; python3 main.py --arch VGG16 --input_dim 2 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam --sobel --grayscale; python3 main.py --arch VGG16 --input_dim 2 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam --sobel --grayscale; python3 main.py --arch ResNet18 --input_dim 2 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam --sobel --grayscale; python3 main.py --arch ResNet18 --input_dim 2 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam --sobel --grayscale; python3 main.py --arch FeedForward --input_dim 2 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam --sobel --grayscale; python3 main.py --arch FeedForward --input_dim 2 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --optimizer Adam --optimizer_tl Adam --sobel --grayscale;
```


---

## Contrastive Strategies

### Strategy 1
```bash
python3 main.py --arch AlexNet --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --contrastive_strategy_1; python3 main.py --arch AlexNet --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --contrastive_strategy_1; python3 main.py --arch VGG16 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --contrastive_strategy_1; python3 main.py --arch VGG16 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 32 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --contrastive_strategy_1; python3 main.py --arch ResNet18 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method faiss --pca_whitening --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --contrastive_strategy_1; python3 main.py --arch ResNet18 --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --pca --pca_method sklearn --pca_whitening --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --contrastive_strategy_1; python3 main.py --arch FeedForward --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering faiss --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --contrastive_strategy_1; python3 main.py --arch FeedForward --input_dim 3 --num_classes 10 --epochs 25 --requires_grad --dataset GTSRB --ds_train --batch_size 128 --reassign_optimizer_tl --clustering sklearn --metrics --metrics_dir ./metrics/GTSRB/5_runs_100_epochs/ -v --contrastive_strategy_1;
```